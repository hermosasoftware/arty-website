---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.tsx';
import ProjectGallery from '../../components/ProjectGallery.tsx';
import ProjectHeader from '../../components/ProjectHeader.astro';

export async function getStaticPaths() {
  return [
    { params: { slug: 'casa-b' } },
    { params: { slug: 'casa-c' } },
    { params: { slug: 'linda-vista' } },
    { params: { slug: 'casa-punta-del-rio' } },
    { params: { slug: 'casa-mariposario' } },
    { params: { slug: 'casa-esfera' } },
  ];
}

const { slug } = Astro.params;

// Project data - in a real app, this would come from a CMS or database
const projects: Record<string, any> = {
  'casa-b': {
    title: 'Casa B',
    subtitle: 'Contemporary residential design featuring clean lines and sustainable materials',
    description: 'Casa B is a cozy retreat where the architecture feels close, intimate, and natural. The polished concrete floors and walls create a solid and elegant base, while the wood details add warmth and texture, enveloping every corner with a sense of home. The heart of the house lies in the fluid relationship between the spaces: the kitchen, living room, terrace, and pool intertwine in the same environment, designed to enjoy community life without losing harmony with the surroundings.',
    year: '2023',
    location: 'Ballena, Osa',
    size: '4,500 sq ft',
    type: 'Residential',
    architect: 'Lead Architect',
    images: [
      '/assets/project-images/CASA-B.png',
      '/assets/project-images/Casa B/Casa-B-interior.jpg',
      '/assets/project-images/Casa B/Casa-B-Pool.jpg',
      '/assets/project-images/Casa B/Casa-B-interior-v2.jpg',
      '/assets/project-images/Casa B/Casa-B-Exterior-v2.jpg',
      '/assets/project-images/Casa B/Casa-B-interior-v3.jpg',
    ],
    blueprints: [
      '/assets/project-images/Casa B/Casa-B-Blueprint.jpg'
    ],
    features: [
      'Open floor plan with seamless indoor-outdoor flow',
      'Energy-efficient design with solar panel integration',
      'Premium materials including natural stone and hardwood',
      'Smart home technology integration',
      'Landscaped garden with native plant species',
      'Three-car garage with electric vehicle charging'
    ]
  },
  'casa-c': {
    title: 'Casa C',
    subtitle: 'Modern workspace design promoting collaboration and productivity',
    description: 'This cutting-edge office building redefines the modern workplace, creating an environment that fosters innovation and collaboration. The design emphasizes natural light, flexible spaces, and sustainable materials to create a productive and inspiring work environment.',
    year: '2023',
    location: 'Ballena, Osa',
    size: '25,000 sq ft',
    type: 'Commercial',
    architect: 'Lead Architect',
    images: [
      '/assets/project-images/Casa C/Casa-C-Exterior.jpg',
      '/assets/project-images/CASA-C.png',
      '/assets/carousel-images/C4-Image.jpg',
      '/assets/project-images/Casa Vista Linda/Linda-Vista-Interior-v2.jpg',
      '/assets/project-images/Casa Vista Linda/Linda-Vista-Exterior.jpg',
      '/assets/project-images/Casa Vista Linda/Linda-Vista-Interior-v2.jpg',
    ],
    blueprints: [
      '/assets/project-images/Casa Vista Linda/Linda-Vista-Blueprint.jpg'
    ],
    features: [
      'Open-plan workspace with flexible furniture systems',
      'Collaboration zones with writable walls',
      'Private meeting rooms with video conferencing',
      'Wellness center with fitness facilities',
      'Rooftop terrace with city views',
      'LEED Platinum certification',
      'Bike storage and electric vehicle charging'
    ]
  },
  'linda-vista': {
    title: 'Casa Vista Linda',
    subtitle: 'Casa Vista Linda, located in Chontales de Osa, has been architecturally designed to maximize the property\'s breathtaking views.',
    description: 'Casa Vista Linda, located in Chontales de Osa, has been architecturally designed to maximize the property’s stunning views. The common areas, such as the kitchen and living room, are seamlessly integrated with the terrace and pool, and each of the bedrooms offers ocean views. As its name suggests, most of the spaces provide access to a “Vista Linda”',
    year: '2022',
    location: 'Chontales, Osa',
    size: '8,500 sq ft',
    type: 'Residential',
    architect: 'Lead Architect',
    images: [
      '/assets/project-images/CASA-VISTA-LINDA.png',
      '/assets/carousel-images/C2-Image.png',
      '/assets/carousel-images/C1-Image.png',
      '/assets/project-images/Casa Vista Linda/Linda-Vista-interior.jpg',
      '/assets/project-images/Casa Vista Linda/Linda-Vista-Exterior.jpg',
      '/assets/project-images/Casa Vista Linda/Linda-Vista-Interior-v2.jpg',
    ],
    blueprints: [
      '/assets/project-images/Casa Vista Linda/Linda-Vista-Blueprint.jpg'
    ],
    features: [
      'Grand entrance with double-height foyer',
      'Master suite with private balcony and ocean views',
      'Professional-grade kitchen with custom cabinetry',
      'Wine cellar with climate control system',
      'Home theater with surround sound',
      'Infinity pool with integrated spa',
      'Guest house with separate entrance'
    ]
  },
  'casa-punta-del-rio': {
    title: 'Casa Punta del Rio',
    subtitle: 'This project, located in Marina Vista, Dominicalito, was designed to blend architecture with nature in a single harmonious language.',
    description:"This project, located in Marina Vista, Dominicalito, was conceived to blend architecture with nature in a single harmonious language. With a view that embraces both the sea and the mountains, the house becomes a sensory refuge where the serenity of the ocean and the majesty of the tropical forest converge. Inspired by the Jungle Modern Design concept, we developed an architectural proposal that exudes freedom and natural elegance, accompanied by purposefully designed furniture and a mood board of fresh, light, and organic finishes that elevate the aesthetic and emotional experience of the space.",
    year: '2022',
    location: 'Dominicalito, Osa',
    size: '1,500 sq ft',
    type: 'Residential',
    architect: 'Lead Architect',
    images: [
      '/assets/project-images/CASA-PUNTA-DEL-RIO.jpg',
      '/assets/carousel-images/C3-v2-Image.png',
      '/assets/project-images/Casa Punta del Rio/PUNTA-DEL-RIO-EXTERIOR.jpg',
      '/assets/project-images/Casa Punta del Rio/PUNTA-DEL-RIO-INTERIOR.jpg',
      '/assets/project-images/Casa Punta del Rio/PUNTA-DEL-RIO-INTERIOR-V2.jpg',
      '/assets/project-images/Casa Punta del Rio/PUNTA-DEL-RIO-EXTERIOR-V2.jpg',
    ],
    blueprints: [
      '/assets/project-images/Casa Punta del Rio/PUNTA-DEL-RIO-BLUEPRINT.jpg'
    ],
    features: [
      'Open floor plan with seamless indoor-outdoor flow',
      'Energy-efficient design with solar panel integration',
      'Premium materials including natural stone and hardwood',
      'Smart home technology integration',
      'Landscaped garden with native plant species',
      'Three-car garage with electric vehicle charging'
    ]
  },
  'casa-mariposario': {
    title: 'Casa Mariposario',
    subtitle: 'Designed to live in harmony with nature, this house opens up to its surroundings with interconnected spaces.',
    description: 'Designed to live in harmony with nature, this house opens up to its surroundings with interconnected spaces filled with light and air. The large windows invite the landscape to be part of everyday life, while the fluid layout allows every corner to feel alive and connected. Wood as the main material provides a sense of warmth and naturalness, while the earth-toned walls embrace the environment with a cozy and organic vibe. It is a house that breathes with its surroundings, designed to be enjoyed from within.',
    year: '2022',
    location: 'Ballena, Osa',
    size: '1,500 sq ft',
    type: 'Residential',
    architect: 'Lead Architect',
    images: [
      '/assets/project-images/CASA-MARIPOSARIO.jpg',
      '/assets/project-images/Casa Mariposario/MARIPOSARIO-POOL.jpg',
      '/assets/project-images/Casa Mariposario/MARIPOSARIO-EXTERIOR.jpg',
      '/assets/project-images/Casa Mariposario/MARIPOSARIO-EXTERIOR-V2.jpg',
      '/assets/project-images/Casa Mariposario/MARIPOSARIO-GARDEN.jpg',
      '/assets/project-images/Casa Mariposario/MARIPOSARIO-INTERIOR-V2.jpg',
    ],
    blueprints: [
      '/assets/project-images/Casa Mariposario/MARIPOSARIO-BLUEPRINT.jpg'
    ],
    features: [
      'Open-plan workspace with flexible furniture systems',
      'Collaboration zones with writable walls',
      'Private meeting rooms with video conferencing',
      'Wellness center with fitness facilities',
      'Rooftop terrace with city views',
      'LEED Platinum certification',
      'Bike storage and electric vehicle charging'
    ]
  },
  'casa-esfera': {
    title: 'Casa Esfera',
    subtitle: 'Casa Esfera is a contemporary retreat that combines modern lines with a fresh and bright atmosphere.',
    description: 'Casa Esfera is a contemporary retreat that blends modern lines with a fresh, luminous atmosphere. Its concept revolves around a black-and-white palette that enhances spatial clarity and creates an elegant contrast, highlighting every architectural detail. Located in a privileged setting, the residence opens toward the horizon with panoramic ocean views, allowing natural light to flood each space and reinforce the sense of openness and connection with nature. The design is complemented by teak wood accents, adding warmth and texture to the composition. These natural elements soften the restraint of the monochrome scheme, achieving a perfect balance between modernity and comfort. Casa Esfera is designed for those seeking a sophisticated, airy, and light-filled lifestyle — where architecture and landscape merge in perfect harmony.',
    year: '2022',
    location: 'Chontales, Osa',
    size: '1,500 sq ft',
    type: 'Residential',
    architect: 'Lead Architect',
    images: [
      '/assets/project-images/CASA-ESFERA.jpg',
      '/assets/project-images/CASA-ESFERA/ESFERA-EXTERIOR.jpg',
      '/assets/project-images/CASA-ESFERA/ESFERA-INTERIOR.jpg',
      '/assets/project-images/CASA-ESFERA/ESFERA-INTERIOR-V2.jpg',
      '/assets/project-images/CASA-ESFERA/ESFERA-EXTERIOR-V2.JPG',
      '/assets/project-images/CASA-ESFERA/ESFERA-INTERIOR-V3.jpg',
    ],
    blueprints: [
      '/assets/project-images/CASA-ESFERA/ESFERA-BLUEPRINT.jpg'
    ],
    features: [
      'Grand entrance with double-height foyer',
      'Master suite with private balcony and ocean views',
      'Professional-grade kitchen with custom cabinetry',
      'Wine cellar with climate control system',
      'Home theater with surround sound',
      'Infinity pool with integrated spa',
      'Guest house with separate entrance'
    ]
  },
};

const project = projects[slug];
---

<Layout title={`${project.title} - Project Details`}>
  <ProjectHeader />
  
  <div class="project-detail">
    <!-- Project Header -->
    <section class="project-header">
      <div class="container">
        <nav class="breadcrumb">
          <a href="/">Home</a> / <a href="/#projects">Projects</a> / <span>{project.title}</span>
        </nav>
        <div class="project-intro">
          <div class="project-meta">
            <h1>{project.title}</h1>
            <p class="project-subtitle">{project.subtitle}</p>
            <div class="grid lg:grid-cols-[1fr_2fr] grid-cols-1 w-full">
              <div class="detail-item lg:w-10/12 pr-2">
                <span class="label">Year:</span>
                <span class="value">{project.year}</span>
              </div>
              <div class="detail-item lg:w-full pl-2">
                <span class="label">Location:</span>
                <span class="value">{project.location}</span>
              </div>
              <div class="detail-item lg:w-10/12 pr-2">
                <span class="label">Size:</span>
                <span class="value">{project.size}</span>
              </div>
              <div class="detail-item lg:w-full pl-2">
                <span class="label">Type:</span>
                <span class="value">{project.type}</span>
              </div>
            </div>
          </div>
          <div class="project-image">
            <img src={project.images[0]} alt={project.title} />
          </div>
        </div>
      </div>
    </section>

      <!-- Project Description -->
    <section class="lg:px-16 w-screen lg:w-full">
      <div class="lg:flex lg:flex-row flex-col justify-between w-screen lg:w-full">
        <div class="lg:w-1/2 p-8 lg:pl-0 w-full" >
          <h2 class="text-3xl font-semibold mb-6 lg:ml-8 text-gray-700 lg:text-left text-center">Architectural Plans</h2>
          <div class="">
            {project?.blueprints?.map((blueprint: string, index: number) => (
              <div class="blueprint-item w-full h-full">
                <img src={blueprint} alt={`${project.title} - Blueprint ${index + 1}`} />
              </div>
            ))}
          </div>
        </div>
        <div class="lg:w-1/2 p-8 lg:ml-8 lg:pl-0 w-full">
          <h2 class="text-3xl font-semibold mb-6 text-gray-700 lg:text-left text-center">Project Overview</h2>
          <p class="text-lg text-gray-600 leading-loose text-center lg:text-left">{project.description}</p>
        </div>
      </div>
    </section>

    <!-- Project Gallery -->
    <section class="project-gallery">
      <div class="container">
        <h2>Project Gallery</h2>
        <ProjectGallery 
          images={project.images} 
          projectTitle={project.title}
          client:load
        />
      </div>
    </section>

    <!-- Features Section -->
    <section class="features-section">
      <div class="container">
        <h2>Key Features</h2>
        <div class="features-grid">
          {project.features.map((feature: string) => (
            <div class="feature-item">
              <div class="feature-icon">✓</div>
              <p>{feature}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Back to Projects -->
    <section class="back-to-projects">
      <div class="container">
        <a href="/#projects" class="back-btn">← Back to All Projects</a>
      </div>
    </section>
  </div>

  <!-- Image Modal -->
  <div id="imageModal" class="modal">
    <span class="close" onclick="closeModal()">&times;</span>
    <img class="modal-content" id="modalImage">
    <div class="modal-caption" id="modalCaption"></div>
  </div>

  <style>
    .project-detail {
      padding-top: 70px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* Project Header */
    .project-header {
      padding: 4rem 0;
      background-color: #fff;
    }

    .breadcrumb {
      margin-bottom: 2rem;
      color: #666;
    }

    .breadcrumb a {
      color: #333;
      text-decoration: none;
    }

    .breadcrumb a:hover {
      text-decoration: underline;
    }

    .project-intro {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4rem;
      align-items: center;
    }

    .project-meta h1 {
      font-size: 3rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: #333;
    }

    .project-subtitle {
      font-size: 1.25rem;
      color: #666;
      margin-bottom: 2rem;
      line-height: 1.6;
    }

    .detail-item {
      display: flex;
      justify-content: space-between;
      padding: 0.75rem 0;
      border-bottom: 1px solid #e9ecef;

    }

    .detail-item .label {
      font-weight: 500;
      color: #333;
    }

    .detail-item .value {
      color: #666;
    }

    .project-image img {
      width: 100%;
      height: 400px;
      object-fit: cover;
      border-radius: 8px;
    }

    /* Project Description */


    /* Project Gallery */
    .project-gallery {
      padding: 4rem 0;
      background-color: #fff;
    }

    .project-gallery h2 {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 2rem;
      color: #333;
      text-align: center;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1rem;
    }

    .gallery-item {
      cursor: pointer;
      border-radius: 8px;
      overflow: hidden;
      transition: transform 0.3s ease;
    }

    .gallery-item:hover {
      transform: scale(1.02);
    }

    .gallery-item img {
      width: 100%;
      height: 250px;
      object-fit: cover;
    }

    /* Blueprints Section */
    .blueprints-section {
      padding: 4rem 0;
    }

    .blueprints-section h2 {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 2rem;
      color: #333;
      text-align: center;
    }

    .blueprints-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    }

    .blueprint-item img {
      object-fit: contain;
      background-color: #fff;
      border-radius: 8px;
    }

    /* Features Section */
    .features-section {
      padding: 4rem 0;
      background-color: #fff;
    }

    .features-section h2 {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 2rem;
      color: #333;
      text-align: center;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .feature-item {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 1.5rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .feature-icon {
      background-color: #333;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.875rem;
      flex-shrink: 0;
    }

    .feature-item p {
      color: #666;
      line-height: 1.6;
      margin: 0;
    }

    /* Back to Projects */
    .back-to-projects {
      padding: 2rem 0;
      text-align: center;
    }

    .back-btn {
      display: inline-block;
      padding: 1rem 2rem;
      background-color: #333;
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-weight: 500;
      transition: background-color 0.3s ease;
    }

    .back-btn:hover {
      background-color: #555;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
    }

    .modal-content {
      margin: auto;
      display: block;
      width: 80%;
      max-width: 700px;
      max-height: 80%;
      object-fit: contain;
    }

    .close {
      position: absolute;
      top: 15px;
      right: 35px;
      color: #f1f1f1;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover {
      color: #bbb;
    }

    .modal-caption {
      margin: auto;
      display: block;
      width: 80%;
      max-width: 700px;
      text-align: center;
      color: #ccc;
      padding: 10px 0;
      height: 150px;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .project-intro {
        grid-template-columns: 1fr;
        gap: 2rem;
      }

      .project-meta h1 {
        font-size: 2rem;
      }

      .project-details {
        grid-template-columns: 1fr;
      }

      .gallery-grid {
        grid-template-columns: 1fr;
      }

      .blueprints-grid {
        grid-template-columns: 1fr;
      }

      .features-grid {
        grid-template-columns: 1fr;
      }

      .modal-content {
        width: 95%;
      }
    }
  </style>

  <script>
    // Navigation function for SPA behavior
    function navigateToProjects() {
      // Simply navigate to home page with projects hash
      window.location.href = '/#projects';
    }

    // Handle header navigation for project pages
    function setupHeaderNavigation() {
      // Wait for header to be available
      const headerLinks = document.querySelectorAll('header a[href^="#"]');
      if (headerLinks.length === 0) {
        // If header not ready, try again in 100ms
        setTimeout(setupHeaderNavigation, 100);
        return;
      }
      
      headerLinks.forEach(link => {
        // Remove any existing listeners
        link.removeEventListener('click', handleHeaderClick);
        // Add new listener
        link.addEventListener('click', handleHeaderClick);
      });
    }

    function handleHeaderClick(e: Event) {
      e.preventDefault();
      const href = (e.target as HTMLAnchorElement).getAttribute('href');
      if (href && href.startsWith('#')) {
        window.location.href = `/${href}`;
      }
    }

    // Setup navigation when DOM is ready
    document.addEventListener('DOMContentLoaded', setupHeaderNavigation);
    
    // Also setup after a delay to catch React hydration
    setTimeout(setupHeaderNavigation, 500);

    // Image modal functionality
    function openModal(index: number) {
      const modal = document.getElementById('imageModal');
      const modalImg = document.getElementById('modalImage') as HTMLImageElement;
      const caption = document.getElementById('modalCaption');
      // Get images from a DOM element or global JS variable you set in the HTML
      // E.g. window.PROJECT_IMAGES or data-attributes
      const imagesAttr = document.getElementById('imageModal')?.getAttribute('data-images');
      const titleAttr = document.getElementById('imageModal')?.getAttribute('data-title');
      let images: string[] = [];
      try {
        if (imagesAttr) {
          images = JSON.parse(imagesAttr);
        }
      } catch (e) {
        images = [];
      }
      
      if (modal && modalImg && caption && Array.isArray(images) && images[index]) {
        modal.style.display = 'block';
        modalImg.src = images[index];
        caption.innerHTML = `{project.title} - Image ${index + 1}`;
      }
    }

    function closeModal() {
      const modal = document.getElementById('imageModal');
      if (modal) {
        modal.style.display = 'none';
      }
    }

    // Close modal when clicking outside the image
    window.onclick = function(event: Event) {
      const modal = document.getElementById('imageModal');
      if (event.target === modal) {
        if (modal) {
          modal.style.display = 'none';
        }
      }
    }

    // Close modal with Escape key
    document.addEventListener('keydown', function(event: KeyboardEvent) {
      if (event.key === 'Escape') {
        closeModal();
      }
    });
  </script>
</Layout>

